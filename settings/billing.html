<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instituto Dutra - Faturas & Pagamentos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../styles/global.css">
    <script src="../styles/theme.js"></script>
    <style>
        body {
            min-height: 100vh;
            padding-bottom: 80px;
        }

        /* Header - usa componentes globais */
        .headerTitle {
            flex: 1;
        }
        
        .headerTitle h1 {
            color: var(--neutral-white);
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .headerTitle p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        /* Main Content */
        .mainContent {
            padding: 20px;
        }

        /* Summary Card */
        .summaryCard {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 24px;
            color: var(--neutral-white);
            position: relative;
            overflow: hidden;
        }

        .summaryCard::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .summaryGrid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .summaryItem {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            padding: 16px;
        }

        .summaryLabel {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .summaryValue {
            font-size: 24px;
            font-weight: 700;
        }

        .nextPayment {
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .paymentInfo {
            flex: 1;
        }

        .paymentDate {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .paymentAmount {
            font-size: 14px;
            opacity: 0.9;
        }

        .paymentButton {
            padding: 8px 16px;
            background: var(--neutral-white);
            color: var(--primary);
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .paymentButton:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
        }

        /* Filter Tabs */
        .filterTabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 4px;
        }

        .filterTab {
            background: var(--neutral-white);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
            box-shadow: var(--shadow-xs);
        }

        .filterTab.active {
            background: var(--primary);
            color: var(--neutral-white);
        }

        /* Invoice List */
        .invoicesList {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .invoiceCard {
            background: var(--neutral-white);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .invoiceCard:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .invoiceCard.paid {
            border-left: 4px solid var(--success-color);
        }

        .invoiceCard.pending {
            border-left: 4px solid var(--accent-beige);
        }

        .invoiceCard.overdue {
            border-left: 4px solid var(--error-color);
        }

        .invoiceHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .invoiceNumber {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .invoiceStatus {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .invoiceStatus.paid {
            background: rgba(58, 74, 58, 0.1);
            color: var(--success-color);
        }

        .invoiceStatus.pending {
            background: rgba(154, 131, 100, 0.1);
            color: var(--accent-beige);
        }

        .invoiceStatus.overdue {
            background: rgba(196, 185, 179, 0.1);
            color: var(--error-color);
        }

        .invoiceDetails {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .invoiceDetail {
            text-align: center;
        }

        .detailLabel {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .detailValue {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .invoiceActions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .actionButton {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .actionButton.primary {
            background: var(--primary);
            color: var(--neutral-white);
        }

        .actionButton.primary:hover {
            background: var(--primary-light);
        }

        .actionButton.secondary {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .actionButton.secondary:hover {
            background: var(--primary);
            color: var(--neutral-white);
        }

        /* Payment Methods */
        .paymentMethods {
            background: var(--neutral-white);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-sm);
        }

        .sectionTitle {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sectionIcon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(58, 74, 58, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 18px;
        }

        .paymentMethodsList {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .paymentMethodCard {
            background: var(--background-lighter);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .methodIcon {
            width: 48px;
            height: 32px;
            background: linear-gradient(135deg, #1A365D, #2D3748);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neutral-white);
            font-size: 12px;
            font-weight: 700;
        }

        .methodIcon.visa {
            background: linear-gradient(135deg, #1A1F71, #0E4FB8);
        }

        .methodIcon.master {
            background: linear-gradient(135deg, #EB001B, #F79E1B);
        }

        .methodIcon.pix {
            background: linear-gradient(135deg, #32BCAD, #0A9E8A);
        }

        .methodInfo {
            flex: 1;
        }

        .methodName {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .methodDetails {
            font-size: 12px;
            color: var(--text-muted);
        }

        .methodDefault {
            background: var(--primary);
            color: var(--neutral-white);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Statistics */
        .statsGrid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .statCard {
            background: var(--neutral-white);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            text-align: center;
        }

        .statIcon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neutral-white);
            font-size: 24px;
            margin: 0 auto 12px;
        }

        .statValue {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .statLabel {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* Responsividade */
        @media (max-width: 480px) {
            .summaryGrid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .invoiceDetails {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .invoiceActions {
                flex-direction: column;
                align-items: stretch;
            }

            .nextPayment {
                flex-direction: column;
                text-align: center;
                gap: 12px;
            }

            .statsGrid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="headerGradient">
        <div class="headerContent">
            <button class="backBtn" onclick="goBack()">
                <i class="mdi mdi-arrow-left"></i>
            </button>
            <div class="headerTitle">
                <h1>Faturas & Pagamentos</h1>
                <p>Histórico completo de cobranças</p>
            </div>
            <button class="btnIcon" onclick="downloadStatement()">
                <i class="mdi mdi-download"></i>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="mainContent">
        <!-- Summary -->
        <div class="summaryCard" style="animation: fadeInUp 0.6s ease-out;">
            <div class="summaryGrid">
                <div class="summaryItem">
                    <div class="summaryLabel">Total Pago</div>
                    <div class="summaryValue">R$ 9.680</div>
                </div>
                <div class="summaryItem">
                    <div class="summaryLabel">Este Ano</div>
                    <div class="summaryValue">R$ 7.200</div>
                </div>
            </div>
            <div class="nextPayment">
                <div class="paymentInfo">
                    <div class="paymentDate">Próximo Pagamento</div>
                    <div class="paymentAmount">15 de dezembro • R$ 1.200</div>
                </div>
                <button class="paymentButton" onclick="payEarly()">Pagar Antecipado</button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="statsGrid" style="animation: fadeInUp 0.8s ease-out;">
            <div class="statCard">
                <div class="statIcon">
                    <i class="mdi mdi-receipt"></i>
                </div>
                <div class="statValue">12</div>
                <div class="statLabel">Faturas pagas</div>
            </div>
            <div class="statCard">
                <div class="statIcon">
                    <i class="mdi mdi-calendar-check"></i>
                </div>
                <div class="statValue">100%</div>
                <div class="statLabel">Em dia</div>
            </div>
        </div>

        <!-- Payment Methods -->
        <div class="paymentMethods" style="animation: fadeInUp 1.0s ease-out;">
            <div class="sectionTitle">
                <div class="sectionIcon">
                    <i class="mdi mdi-credit-card"></i>
                </div>
                Formas de Pagamento
            </div>
            
            <div class="paymentMethodsList">
                <div class="paymentMethodCard">
                    <div class="methodIcon visa">VISA</div>
                    <div class="methodInfo">
                        <div class="methodName">Cartão de Crédito</div>
                        <div class="methodDetails">•••• •••• •••• 4532 • Expira 08/2026</div>
                    </div>
                    <div class="methodDefault">Padrão</div>
                </div>
                <div class="paymentMethodCard">
                    <div class="methodIcon pix">PIX</div>
                    <div class="methodInfo">
                        <div class="methodName">PIX Automático</div>
                        <div class="methodDetails">Banco Itaú • Agência 1234</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="filterTabs" style="animation: fadeInUp 1.2s ease-out;">
            <button class="filterTab active" onclick="filterInvoices('all')">Todas</button>
            <button class="filterTab" onclick="filterInvoices('paid')">Pagas</button>
            <button class="filterTab" onclick="filterInvoices('pending')">Pendentes</button>
            <button class="filterTab" onclick="filterInvoices('overdue')">Vencidas</button>
        </div>

        <!-- Invoices List -->
        <div class="section" style="animation: fadeInUp 1.4s ease-out;">
            <div class="sectionHeader">
                <h2 class="sectionTitle">Histórico de Faturas</h2>
                <button class="btnPrimary btnXs btnInline" onclick="exportHistory()">
                    Exportar
                </button>
            </div>

            <div class="invoicesList" id="invoicesList">
                <!-- Fatura 1 - Paid -->
                <div class="invoiceCard paid" data-status="paid" onclick="viewInvoice('INV-2024-007')">
                    <div class="invoiceHeader">
                        <div class="invoiceNumber">Fatura #INV-2024-007</div>
                        <div class="invoiceStatus paid">Paga</div>
                    </div>
                    <div class="invoiceDetails">
                        <div class="invoiceDetail">
                            <div class="detailLabel">Data de Emissão</div>
                            <div class="detailValue">15/07/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Vencimento</div>
                            <div class="detailValue">20/07/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Valor</div>
                            <div class="detailValue">R$ 1.200,00</div>
                        </div>
                    </div>
                    <div class="invoiceActions">
                        <button class="actionButton secondary" onclick="downloadInvoice('INV-2024-007')">
                            <i class="mdi mdi-download"></i> Download
                        </button>
                        <button class="actionButton secondary" onclick="viewDetails('INV-2024-007')">
                            Ver Detalhes
                        </button>
                    </div>
                </div>

                <!-- Fatura 2 - Paid -->
                <div class="invoiceCard paid" data-status="paid" onclick="viewInvoice('INV-2024-006')">
                    <div class="invoiceHeader">
                        <div class="invoiceNumber">Fatura #INV-2024-006</div>
                        <div class="invoiceStatus paid">Paga</div>
                    </div>
                    <div class="invoiceDetails">
                        <div class="invoiceDetail">
                            <div class="detailLabel">Data de Emissão</div>
                            <div class="detailValue">15/06/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Vencimento</div>
                            <div class="detailValue">20/06/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Valor</div>
                            <div class="detailValue">R$ 1.200,00</div>
                        </div>
                    </div>
                    <div class="invoiceActions">
                        <button class="actionButton secondary" onclick="downloadInvoice('INV-2024-006')">
                            <i class="mdi mdi-download"></i> Download
                        </button>
                        <button class="actionButton secondary" onclick="viewDetails('INV-2024-006')">
                            Ver Detalhes
                        </button>
                    </div>
                </div>

                <!-- Fatura 3 - Initial Payment -->
                <div class="invoiceCard paid" data-status="paid" onclick="viewInvoice('INV-2024-001')">
                    <div class="invoiceHeader">
                        <div class="invoiceNumber">Fatura #INV-2024-001</div>
                        <div class="invoiceStatus paid">Paga</div>
                    </div>
                    <div class="invoiceDetails">
                        <div class="invoiceDetail">
                            <div class="detailLabel">Data de Emissão</div>
                            <div class="detailValue">15/05/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Vencimento</div>
                            <div class="detailValue">20/05/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Valor</div>
                            <div class="detailValue">R$ 6.480,00</div>
                        </div>
                    </div>
                    <div class="invoiceActions">
                        <button class="actionButton secondary" onclick="downloadInvoice('INV-2024-001')">
                            <i class="mdi mdi-download"></i> Download
                        </button>
                        <button class="actionButton secondary" onclick="viewDetails('INV-2024-001')">
                            Ver Detalhes
                        </button>
                    </div>
                </div>

                <!-- Fatura 4 - Future/Pending -->
                <div class="invoiceCard pending" data-status="pending" onclick="viewInvoice('INV-2024-008')">
                    <div class="invoiceHeader">
                        <div class="invoiceNumber">Fatura #INV-2024-008</div>
                        <div class="invoiceStatus pending">Pendente</div>
                    </div>
                    <div class="invoiceDetails">
                        <div class="invoiceDetail">
                            <div class="detailLabel">Data de Emissão</div>
                            <div class="detailValue">15/12/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Vencimento</div>
                            <div class="detailValue">20/12/2024</div>
                        </div>
                        <div class="invoiceDetail">
                            <div class="detailLabel">Valor</div>
                            <div class="detailValue">R$ 1.200,00</div>
                        </div>
                    </div>
                    <div class="invoiceActions">
                        <button class="actionButton primary" onclick="payInvoice('INV-2024-008')">
                            <i class="mdi mdi-credit-card"></i> Pagar
                        </button>
                        <button class="actionButton secondary" onclick="viewDetails('INV-2024-008')">
                            Ver Detalhes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottomNav">
        <a href="../index.html" class="navItem">
            <i class="mdi mdi-home navIcon"></i>
            <span class="navLabel">Home</span>
        </a>
        <a href="../schedule/index.html" class="navItem">
            <i class="mdi mdi-calendar navIcon"></i>
            <span class="navLabel">Agenda</span>
        </a>
        <a href="../communication/index.html" class="navItem">
            <i class="mdi mdi-chat navIcon"></i>
            <span class="navLabel">Chat</span>
        </a>
        <a href="../profile/index.html" class="navItem">
            <i class="mdi mdi-account navIcon"></i>
            <span class="navLabel">Perfil</span>
        </a>
    </nav>

    <script>
        // Sistema de temas integrado
        function loadTheme() {
            const savedTheme = localStorage.getItem('instituto-dutra-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // Navegação
        function goBack() {
            window.location.href = 'plan.html';
        }

        // Filter invoices
        function filterInvoices(status) {
            // Update active tab
            document.querySelectorAll('.filterTab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filter invoices
            const invoices = document.querySelectorAll('.invoiceCard');
            invoices.forEach(invoice => {
                const invoiceStatus = invoice.getAttribute('data-status');
                if (status === 'all' || invoiceStatus === status) {
                    invoice.style.display = 'block';
                } else {
                    invoice.style.display = 'none';
                }
            });

            console.log(`Filtrando faturas: ${status}`);
        }

        // Invoice actions
        function viewInvoice(invoiceId) {
            console.log(`Visualizar fatura: ${invoiceId}`);
        }

        function downloadInvoice(invoiceId) {
            event.stopPropagation();
            alert(`Download da Fatura ${invoiceId}\n\n• Formato: PDF\n• Tamanho: 245 KB\n• Assinatura digital válida\n\nSalvando na pasta Downloads...\n\n(Demo)`);
        }

        function viewDetails(invoiceId) {
            event.stopPropagation();
            const invoiceDetails = {
                'INV-2024-007': 'Plano VIP • Julho 2024\nConsultas: 2x realizadas\nMounjaro: 4x aplicações\nSoroterapia: 2x sessões',
                'INV-2024-006': 'Plano VIP • Junho 2024\nConsultas: 3x realizadas\nMounjaro: 4x aplicações\nSoroterapia: 1x sessão',
                'INV-2024-001': 'Ativação Plano VIP 6 meses\nTaxa de adesão: R$ 480\nDesconto fidelidade: -R$ 720\nValor líquido: R$ 6.480',
                'INV-2024-008': 'Plano VIP • Dezembro 2024\nRenovação automática\nVencimento: 20/12/2024'
            };
            
            alert(`Detalhes da Fatura ${invoiceId}\n\n${invoiceDetails[invoiceId] || 'Detalhes não disponíveis'}\n\nDúvidas: (11) 98765-4321\n\n(Demo)`);
        }

        function payInvoice(invoiceId) {
            event.stopPropagation();
            const confirmed = confirm(`Pagar Fatura ${invoiceId}\n\nValor: R$ 1.200,00\nVencimento: 20/12/2024\n\nForma de pagamento:\n• Cartão VISA ••••4532\n\nConfirmar pagamento?\n\n(Demo)`);
            
            if (confirmed) {
                alert('Pagamento Realizado!\n\nFatura paga com sucesso.\n\n• Comprovante enviado por email\n• Recibo disponível para download\n• Próxima fatura: 15/01/2025\n\n(Demo)');
            }
        }

        function payEarly() {
            alert('Pagamento Antecipado\n\nBenefícios:\n• 5% de desconto (R$ 60)\n• Crédito extra no plano\n• Prioridade no agendamento\n\nValor com desconto: R$ 1.140\nData de cobrança: Imediata\n\nConfirmar pagamento antecipado?\n\n(Demo)');
        }

        function downloadStatement() {
            alert('Extrato Anual\n\nGerando extrato completo:\n\n• Todas as faturas de 2024\n• Resumo de gastos por mês\n• Histórico de tratamentos\n• Comprovantes em PDF\n\nExtrato enviado por email\nDownload iniciado\n\n(Demo)');
        }

        function exportHistory() {
            alert('Exportar Histórico\n\nFormatos disponíveis:\n• PDF - Relatório detalhado\n• Excel - Planilha com dados\n• CSV - Dados para importação\n\nPeríodo: Janeiro - Dezembro 2024\nTotal de registros: 12 faturas\n\nArquivo enviado por email\n\n(Demo)');
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
        });
    </script>
</body>
</html>